% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/biased_match.R
\name{RMMHALG}
\alias{RMMHALG}
\title{Metropolis–Hastings algorithm with linear predictors}
\usage{
RMMHALG(
  B = 5,
  J = 20,
  N1vec = 150,
  N2vec = 200,
  N0vec = 50,
  M1vec = 40,
  M2vec = 60,
  mvec = 10,
  Cvec = 1,
  X,
  B0,
  V0,
  eta = 0.001,
  tau = 1000,
  mu0 = 0,
  sig0 = 0.001,
  muinit = 0,
  rinit = 0,
  del = 0.1
)
}
\arguments{
\item{B}{Integer; number of burn‑in iterations.}

\item{J}{Integer; number of sampling iterations after burn‑in.}

\item{N1vec}{Numeric vector; values of \code{N1} for each observation.}

\item{N2vec}{Numeric vector; values of \code{N2} for each observation.}

\item{N0vec}{Numeric vector; values of \code{N} (number of common items) for each observation.}

\item{M1vec}{Numeric vector; values of \code{m1} (sample sizes from urn 1) for each observation.}

\item{M2vec}{Numeric vector; values of \code{m2} (sample sizes from urn 2) for each observation.}

\item{mvec}{Numeric vector; observed numbers of matches.}

\item{Cvec}{Integer vector; indicator assigning each observation to a weight class (should all be 1 for a single class).}

\item{X}{Numeric matrix; design matrix linking observations to regression
coefficients.}

\item{B0}{Numeric vector; prior mean of regression coefficients.}

\item{V0}{Numeric matrix; prior covariance of regression coefficients.}

\item{eta, tau, mu0, sig0}{Numeric scalars; hyperparameters for priors on \eqn{\lambda} and \eqn{\mu}.}

\item{muinit, rinit}{Numeric; starting values for \eqn{\mu} and the weight parameters.}

\item{del}{Numeric vector of tuning constants for proposal variances.}
}
\value{
A list similar to that returned by \code{\link[=MHALG]{MHALG()}} with additional
components: \code{betv} (matrix of sampled regression coefficients), and
\code{lamv}, \code{rm}, \code{rar} as before.
}
\description{
Extends \code{\link[=MHALG]{MHALG()}} by allowing the weight parameters to depend on a
design matrix \code{X} via a multivariate normal prior.  Each observation
belongs to one of \code{K} weight classes, and the latent log‑weights are
modelled as \code{X \%*\% beta}.  See Puza and Bonfrer (2018) for details.
}
\examples{
# Simulate a small example with a design matrix of two covariates
set.seed(1)
X <- cbind(1, c(1, 0, 1))
res <- RMMHALG(B = 2, J = 5,
               N1vec = c(150, 150, 150), N2vec = c(200, 200, 200),
               N0vec = c(50, 50, 50), M1vec = c(40, 40, 40), M2vec = c(60, 60, 60),
               mvec = c(10, 11, 9), Cvec = c(1, 2, 3),
               X = X, B0 = c(0, 0), V0 = diag(2))
head(res$betv)

}
