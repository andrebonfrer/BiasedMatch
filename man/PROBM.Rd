% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/biased_match.R
\name{PROBM}
\alias{PROBM}
\title{Probability mass function for the number of matching items}
\usage{
PROBM(m = 3, N1 = 37, N2 = 45, N = 16, m1 = 12, m2 = 8, w = 2)
}
\arguments{
\item{m}{Integer; the number of matches for which the probability is
required.}

\item{N1}{Integer; the number of distinct items in urn 1.}

\item{N2}{Integer; the number of distinct items in urn 2.}

\item{N}{Integer; the number of items common to both urns.}

\item{m1}{Integer; the size of the sample drawn from urn 1.}

\item{m2}{Integer; the size of the sample drawn from urn 2.}

\item{w}{Numeric; the weight of a common item relative to a non‑common
item.  A value greater than 1 indicates that common items are more likely
to be selected.}
}
\value{
A single numeric value giving the probability mass at \code{m}.
}
\description{
Given two urns containing overlapping sets of items, this function
computes the probability mass at a particular number of matches \code{m} when
samples are drawn without replacement from each urn with bias.  The
implementation uses Wallenius' and multivariate non‑central hypergeometric
distributions provided by the \pkg{BiasedUrn} package.
}
\details{
Suppose urn 1 contains \code{N1} distinct items, urn 2 contains \code{N2} distinct
items and \code{N} items are common to both urns.  A sample of size \code{m1} is
drawn from urn 1 and a sample of size \code{m2} is drawn from urn 2.  Items
that are common to both urns are sampled with weight \code{w} relative to
non‑overlapping items.  The return value is the probability that the
number of matches between the two samples is exactly \code{m}.

The algorithm enumerates the possible values of \code{y1}, the number of
common items drawn from urn 1, and sums the probability of drawing
\code{m} matches conditional on \code{y1} multiplied by the probability of drawing
\code{y1} common items.  The distribution of \code{y1} is Wallenius' non‑central
hypergeometric distribution computed by
\code{\link[BiasedUrn:BiasedUrn-2-Univariate]{BiasedUrn::dWNCHypergeo()}}, while the conditional distribution of
\code{m} given \code{y1} is computed using the multivariate Wallenius
distribution \code{\link[BiasedUrn:BiasedUrn-3-Multivariate]{BiasedUrn::dMWNCHypergeo()}}.
}
\examples{
# Probability of observing exactly 3 matches when both urns overlap by 16
# items and samples of size 12 and 8 are drawn with weight 2 for common
# items.
PROBM(m = 3, N1 = 37, N2 = 45, N = 16, m1 = 12, m2 = 8, w = 2)

}
\references{
Puza, B. & Bonfrer, A. (2018). \emph{A series of two‑urn biased sampling
problems}. Communications in Statistics – Theory and Methods, 47(1), 80–91.
The functions in this package implement the probability model and inference
routines described in that paper.
}
